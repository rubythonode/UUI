global.BOOT=function(e){"use strict";var n,t,i,o,r,a=require("fs"),s=require("path"),c=e.OTHER_LANGS,d=__dirname+"/..",l="\nglobal = window;\n",u="\nglobal = window;\n",f="",E="",O="";t=function(e){return JSON.stringify(e,function(e,n){return"function"==typeof n?n.toString():n},"	")},i=function(){var i,o,r,O,C,R,p,v,S,N,g,F,m,I,y;i=function(e){var n=e.path,t=e.name;return a.statSync(d+"/"+n).isDirectory()===!0&&"."!==t[0]&&"node_modules"!==t&&"not_load"!==t&&"deprecated"!==t&&"_"!==t[0]},o=function(){a.readdirSync(d).forEach(function(e){i({path:e,name:e})===!0&&(global[e]=BOX(e),l+="global."+e+" = BOX('"+e+"');\n",u+="global."+e+" = BOX('"+e+"');\n")})},r=function(e){var n,t=d+"/"+e,i=s.extname(e);".js"===i&&require(t);for(n in c)c.hasOwnProperty(n)===!0&&i==="."+n&&require(t)},O=function(e){var n,t=d+"/"+e,i=s.extname(e),o=a.readFileSync(t).toString();".js"===i?(l+=o+"\n",u+=o+"\n"):".css"===i&&(f+=o,E+=o);for(n in c)c.hasOwnProperty(n)===!0&&i==="."+n&&(l+=c[n](o)+"\n",u+=c[n](o)+"\n")},C=function(e){var n,t=d+"/"+e,i=s.extname(e),o=a.readFileSync(t).toString();".js"===i?u+=o+"\n":".css"===i&&(E+=o+"\n");for(n in c)c.hasOwnProperty(n)===!0&&i==="."+n&&(u+=c[n](o)+"\n")},R=function(e){r(e),O(e)},p=function(e,n){var t=function(e){var o,r;if(a.existsSync(e)===!0)for(o=[],a.readdirSync(e).forEach(function(t){var r=e+"/"+t;i({path:r,name:t})===!0?o.push(r):a.statSync(d+"/"+r).isDirectory()!==!0&&n(r)}),r=0;r<o.length;r+=1)t(o[r])};FOR_BOX(function(n){t(n.boxName+"/"+e)})},v=function(e){p(e,r)},S=function(e){p(e,O)},N=function(e){p(e,C)},g=function(e){p(e,R)},F=function(){void 0!==e&&(void 0!==e.CONFIG&&(EXTEND_DATA({origin:global.CONFIG,extend:e.CONFIG}),l+="EXTEND_DATA({ origin : global.CONFIG, extend : "+t(e.CONFIG)+" });\n",u+="EXTEND_DATA({ origin : global.CONFIG, extend : "+t(e.CONFIG)+" });\n"),void 0!==e.SERVER_CONFIG&&(EXTEND_DATA({origin:global.SERVER_CONFIG,extend:e.SERVER_CONFIG}),SERVER_CONFIG.rootPath=d),void 0!==e.BROWSER_CONFIG&&(l+="EXTEND_DATA({ origin : global.BROWSER_CONFIG, extend : "+t(e.BROWSER_CONFIG)+" });\n",u+="EXTEND_DATA({ origin : global.BROWSER_CONFIG, extend : "+t(e.BROWSER_CONFIG)+" });\n")),CONFIG.version=String((new Date).getTime()),l+="CONFIG.version = "+CONFIG.version+";\n",u+="CONFIG.version = "+CONFIG.version+";\n"},m=function(){var e=UPPERCASE.MODULE("mongolian");UPPERCASE.db=(new e).db(SERVER_CONFIG.dbName),SERVER_CONFIG.isNotRequireDBAuth!==!0&&UPPERCASE.db.auth(SERVER_CONFIG.dbUsername,SERVER_CONFIG.dbPassword)},I=function(){var e=UPPERCASE.MODULE("uglify-js"),n=UPPERCASE.MODULE("sqwish");l=e.minify(l,{fromString:!0,mangle:!0}).code,u=e.minify(u,{fromString:!0,mangle:!0}).code,f=n.minify(f),E=n.minify(E)},y=function(){n=a.readFileSync(d+"/UPPERCASE/LOGO"),l="/* Welcome to JavaScript World! :)\n"+n+"\n  Contact: "+CONFIG.contactAddress+"\n\n*/"+l,f="/* Welcome to CSS World! :)\n"+n+"\n  Contact: "+CONFIG.contactAddress+"\n\n*/"+f},R("UPPERCASE/METHOD.js"),R("UPPERCASE/CLASS.js"),R("UPPERCASE/OBJECT.js"),R("UPPERCASE/BOX.js"),o(),R("UPPERCASE/FOR_BOX.js"),g("COMMON"),v("SERVER"),S("BROWSER"),N("BROWSER_SECURED"),O("UPPERCASE/BROWSER_FIX.js"),F(),SERVER_CONFIG.isNotUseDB!==!0&&m(),O("UPPERCASE/BROWSER_INIT.js"),CONFIG.isDevMode!==!0&&I(),y()},o=function(){O+="<!DOCTYPE html>",O+="<!--\n\n  Welcome! :)\n"+n+"\n  Contact: "+CONFIG.contactAddress+"\n\n-->",O+="<html>",O+="<head>",O+='<meta charset="utf-8">',O+='<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">',O+='<meta name="google" value="notranslate">',void 0!==CONFIG.googleSiteVerificationKey&&(O+='<meta name="google-site-verification" content="'+CONFIG.googleSiteVerificationKey+'" />'),O+="<title>"+CONFIG.defaultTitle+"</title>",O+='<link rel="stylesheet" type="text/css" href="__CSS?'+CONFIG.version+'" />',O+="</head>",O+="<body>",O+="<noscript>",O+='<p style="padding:15px;">',O+="자바스크립트 기능이 꺼져있습니다. 브라우저의 자바스크립트 기능을 켜 주시기 바랍니다. 감사합니다~! ^-^",O+="<br>",O+="JavaScript is disabled. Please enable JavaScript in your browser. Thank you~! :)",O+="</p>",O+="</noscript>",O+='<script type="text/javascript" src="__SCRIPT?'+CONFIG.version+'"></script>',O+="</body>",O+="</html>"},r=function(){var e,n,t,i,o=require("http"),r=require("https"),c=UPPERCASE.MODULE("socket.io"),C=UPPERCASE.MODULE("formidable").IncomingForm,R=UPPERCASE.MODULE("imagemagick");i=function(e,n){var t,i,o,r,c,p,v,S,N,g,F,m,I,y,G,_,h,P,A,x,D,T,b,U,w,B=e.url,M={};c=function(e){var n=s.extname(e);return".png"===n?"image/png":".jpg"===n||".jpeg"===n?"image/jpeg":".gif"===n?"image/gif":".js"===n?"text/javascript":".css"===n?"text/css":".txt"===n?"text/plain":".html"===n?"text/html":".swf"===n?"application/x-shockwave-flash":"application/octet-stream"},p=function(e){return"text/javascript"===e?"utf-8":"text/css"===e?"utf-8":"text/plain"===e?"binary":"text/html"===e?"utf-8":"image/png"===e?"binary":"image/jpeg"===e?"binary":"image/gif"===e?"binary":"application/x-shockwave-flash"===e?"binary":"binary"},v=function(){var e=B.indexOf("?");-1!==e&&(i=B.substring(e+1),B=B.substring(0,e))},S=function(){t=B.substring(1)},N=function(){var e=t.indexOf("/");-1===e?o=CONFIG.defaultBoxName:(o=t.substring(0,e),t=t.substring(e+1))},g=function(){var e=t.indexOf("/");-1===e?r="":(r=t.substring(0,e),t=t.substring(e+1))},F=function(){var n;return void 0===e.headers.authorization?!1:(n=new Buffer(e.headers.authorization.split(" ")[1],"base64").toString().split(":"),console.log("Decoded authorization: "+n),n[0]===SERVER_CONFIG.securedUsername&&n[1]===SERVER_CONFIG.securedPassword)},m=function(n){return void 0===n?void 0!==e.headers["if-none-match"]:e.headers["if-none-match"]===n},I=function(e){n.writeHead(302,{Location:e}),n.end()},y=function(){console.log("Someone is trying to AUTH!: "+e.connection.remoteAddress),n.statusCode=401,n.setHeader("WWW-Authenticate",'Basic realm="AUTH"'),n.end()},G=function(){n.statusCode=304,n.end()},_=function(e){var t=e.key,i=e.content,o=e.contentType,r=e.encoding;n.setHeader("Content-Type",o),void 0!==t&&n.setHeader("ETag",t),n.statusCode=200,n.end(i,r)},h=function(){I("/"+CONFIG.defaultBoxName+"/R/favicon.ico")},P=function(){return void 0===e.headers.authorization?void y():F()===!0?void I(SERVER_CONFIG.authedPageUrl):void I("/UPPERCASE/R/AUTH_ERROR.html")},A=function(){_({content:O,contentType:"text/html",encoding:"utf-8"})},x=function(){m(CONFIG.version)===!0&&CONFIG.isDevMode!==!0?G():i!==CONFIG.version&&CONFIG.isDevMode!==!0?I(B+"?"+CONFIG.version):_(F()===!0?{key:CONFIG.version,content:u,contentType:"text/javascript",encoding:"utf-8"}:{key:CONFIG.version,content:l,contentType:"text/javascript",encoding:"utf-8"})},D=function(){m(CONFIG.version)===!0&&CONFIG.isDevMode!==!0?G():i!==CONFIG.version&&CONFIG.isDevMode!==!0?I(B+"?"+CONFIG.version):_(F()===!0?{key:CONFIG.version,content:E,contentType:"text/css",encoding:"utf-8"}:{key:CONFIG.version,content:f,contentType:"text/css",encoding:"utf-8"})},T=function(){var t=new C,i=[],r={};t.uploadDir="__RF/"+o+"/__TEMP/",a.existsSync(d+"/"+t.uploadDir)===!1&&console.log("Not exists folder: "+d+"/"+t.uploadDir),void 0!==global[o]&&a.existsSync(d+"/"+t.uploadDir)===!0?(t.on("field",function(e,n){r[e]=n}).on("file",function(e,n){i.push({tempPath:n.path,size:n.size,name:n.name,type:n.type,lastModifiedDate:n.lastModifiedDate})}).on("end",function(){var e=global[o].DB("__UPLOAD_FILE"),t=0;EACH(i,function(a){var s=a.tempPath;return a.size>1024*CONFIG.maxUploadFileMB*1024?(n.writeHead(200,{"Content-Type":"text/html"}),n.end("<script>errorCode='SIZE'</script>","utf-8"),!1):(EACH(r,function(e,n){""!==e.trim()&&(a[n]=e)}),REMOVE_AT({data:a,key:"tempPath"}),void R.readMetadata(s,function(r,c){var l=function(){e.createData(a,function(e,r){var a=UPPERCASE.MODULE("mv"),c=d+"/__RF/"+o+"/"+r.id;void 0===e&&a(s,c,function(){t+=1,t===i.length&&(EACH(i,function(e,n){i[n]=PACK_DATA(e)}),n.writeHead(200,{"Content-Type":"text/html"}),n.end("<script>fileDatas="+JSON.stringify(i)+"</script>","utf-8")),console.log("File '"+c+"' ("+r.name+", "+r.size+" byte) uploaded.")})})};void 0!==c.exif?(a.exif=c.exif,R.convert([s,"-auto-orient",s],function(){l()})):l()}))})}).on("error",function(){n.writeHead(200,{"Content-Type":"text/html"}),n.end("<script>errorCode='ERROR'</script>","utf-8")}),t.parse(e)):(n.writeHead(200,{"Content-Type":"text/html"}),n.end("<script>errorCode='ERROR'</script>","utf-8"))},b=function(){var e,n,r;m(CONFIG.version)===!0?G():i!==CONFIG.version?I(B+"?"+CONFIG.version):(e=d+"/"+o+"/R/"+t,void 0!==M[e]?_(M[e]):(n=c(t),r=p(n),a.exists(e,function(t){t===!0?a.readFile(e,r,function(t,i){null!==t?w():_(M[e]={key:CONFIG.version,content:i,contentType:n,encoding:r})}):w()})))},U=function(){var e;m()===!0?G():(e=d+"/__RF/"+o+"/"+t,a.exists(e,function(n){n===!0?a.readFile(e,"binary",function(n,t){null!==n?w():a.stat(e,function(e,n){null!==e?w():_({key:n.size+"-"+Date.parse(n.mtime),content:t,contentType:"application/octet-stream",encoding:"binary"})})}):w()}))},w=function(){I(SERVER_CONFIG.errorPageUrl)},v(),S(),"favicon.ico"===t?h():"__AUTH"===t?P():""===t?A():"__SCRIPT"===t?x():"__CSS"===t?D():(N(),g(),"R"===r?b(o):"RF"===r?U(o):"__UPLOAD"===t&&"POST"===e.method.toUpperCase()?T():w())},e=o.createServer(i).listen(CONFIG.port),void 0!==SERVER_CONFIG.securedPort&&(n=r.createServer({key:a.readFileSync(d+"/"+SERVER_CONFIG.securedKeyFileName),cert:a.readFileSync(d+"/"+SERVER_CONFIG.securedCrtFileName)},i).listen(SERVER_CONFIG.securedPort)),t=c.listen(e),CONFIG.isDevMode===!0?t.set("log level",2):t.set("log level",1),t.set("transports",["websocket","flashsocket","xhr-polling","jsonp-polling"]),CONNS.type.socketPack=t.sockets,OBJECT.init(),FOR_BOX(function(e){void 0!==e.MAIN&&e.MAIN()}),console.log("[UPPERCASE SERVER STARTED] http://localhost:"+CONFIG.port+(void 0!==SERVER_CONFIG.securedPort?" and secured server started. https://localhost:"+SERVER_CONFIG.securedPort:""))},i(),o(),r()};